<div class="row">
  <div
    *ngFor="let itemList of lists"
    class="aze col-xs-1 col-1 col-md-2 col-lg-2"
  >
    <p style="font-weight: bold">{{ itemList.name }}</p>
    <bs-sortable
      [(ngModel)]="tasksByList[itemList.id]"
      [itemTemplate]="detailedItemTemplate"
      itemClass="sortable-item"
      itemActiveClass="sortable-item-active"
      placeholderItem="Vide"
      placeholderClass="placeholderStyle text-center"
      wrapperClass="sortable-wrapper"
      (onChange)="limitedConsoleL(itemList.name)"
    ></bs-sortable>
  </div>
</div>

<div [class]="'modalList' + (isModalOpen ? '' : ' modalListOpen')">
  <label for="name">Title :</label>
  <input
    class="form-control"
    [(ngModel)]="selectedItem.name"
    name="name"
    id="name"
  />
  <label for="description">Description :</label>
  <input
    class="form-control"
    [(ngModel)]="selectedItem.description"
    name="description"
    id="description"
  />

  <div class="statusMemberWrapper">
    <div class="doubleWrapperDates">
      <label for="listEntityId">Status :</label>
      <select
        class="form-control form-select"
        form-select
        id="lists"
        [(ngModel)]="taskService.selectedItem.listEntityId"
        name="listEntityId"
      >
        <option *ngFor="let listEntity of lists" [value]="listEntity.id">
          {{ listEntity.name }}
        </option>
      </select>
    </div>
    <div class="doubleWrapperDates">
      <label for="title">Members :</label>
      <select
        class="form-control form-select"
        id="members"
        [(ngModel)]="taskService.selectedItem.membreId"
        name="members"
      >
        <option></option>
        <option
          *ngFor="let membreEntity of members"
          [value]="membreEntity.membreId"
        >
          {{ membreEntity.username }}
        </option>
      </select>
    </div>
  </div>

  <div class="statusMemberWrapper">
    <div class="form-group">
      <div class="doubleWrapperDates">
        <label for="startdate">Start Date :</label>
        <input
          type="date"
          class="form-control"
          name="startdate"
          id="startdate"
          [(ngModel)]="selectedItem.startdate"
          [value]="selectedItem.startdate | date : 'yyyy-MM-dd'"
        />
      </div>
    </div>
    <div class="form-group">
      <div class="doubleWrapperDates"></div>
      <label for="date">End Date :</label>
      <input
        type="date"
        class="form-control"
        id="enddate"
        name="enddate"
        [(ngModel)]="selectedItem.enddate"
        [value]="selectedItem.enddate | date : 'yyyy-MM-dd'"
      />
    </div>
  </div>
  <!-- <div id="taskSpanTagWrapper">
  <span
    class="taskSpanTag bs-tooltip-top"
    *ngFor="let tag of taskService.selectedItem.tags"
    (click)="consoleL(tag)"
    data-toggle="tooltip"
    [title]="tag.text"
    [style.background-color]="tag.color"
  >
    {{ tag.text }}
  </span>
</div> -->
  <div id="modalBtnWrapper">
    <button
      class="btn btn-primary"
      cta="delete"
      (click)="deleteModal(selectedItem.id); $event.preventDefault()"
    >
      Delete
    </button>
    <!--     <button
      class="btn btn-primary"
      cta="cancel"
      (click)="updateModal(); $event.preventDefault()"
    >
      Cancel
    </button> -->
    <button
      class="btn btn-primary"
      cta="save"
      (click)="updateModal(); $event.preventDefault()"
    >
      Save
    </button>
  </div>
</div>

<div
  (click)="closeModal()"
  [class]="'modalListBG' + (isModalOpen ? '' : ' modalListOpen')"
></div>

<div *ngIf="taskService.isCreateModalOpen">
  <app-task-form id="modalCreateTask"></app-task-form>
  <div
    class="modalCreateTaskBG"
    (click)="taskService.isCreateModalOpen = !taskService.isCreateModalOpen"
  ></div>
</div>

<div id="listBtnWrapper">
  <button class="createTask editBtnWrapper" (click)="isEditMode = !isEditMode">
    <img src="assets/img/edit.png" alt="edit" />
  </button>
  <button
    class="createTask"
    (click)="taskService.isCreateModalOpen = !taskService.isCreateModalOpen"
  >
    Add
  </button>
</div>

<ng-template #detailedItemTemplate let-item="item" let-index="index">
  <div
    (click)="clickHandle(item)"
    (pointerdown)="consoleL(item.value, item)"
    (mouseup)="onMouseUpHandle($event)"
    class="taskItemtitle"
  >
    {{ item.value.name }}
  </div>
  <div class="btnAndMember">
    <span *ngIf="item.value.nameMemberTask" class="memberBubble">
      {{ item.value.nameMemberTask }}
    </span>
    <span
      class="taskDeleteBtn"
      *ngIf="isEditMode"
      (click)="taskService.deleteTask(item.value.id)"
      >&#215;
    </span>
  </div>
  <!--   <div class="tagIndicator">
    <span
      class="taskSpanTagIndicator"
      *ngFor="let tag of item.value.tags"
      [style.background-color]="tag.color"
    >
    </span>
  </div> -->
</ng-template>
